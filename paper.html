<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Breaking Free from the Xpt: Exploration of dataset.json as an Alternative Transport File to Regulatory Agencies – phuse-datasetjson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fd1faf6fd93e4e6d207ae0f9db51d78.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">phuse-datasetjson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./paper.html" aria-current="page"> 
<span class="menu-text">Paper</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Presentation</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">ABSTRACT</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">INTRODUCTION</a>
  <ul class="collapse">
  <li><a href="#what-we-are-going-to-talk-about" id="toc-what-we-are-going-to-talk-about" class="nav-link" data-scroll-target="#what-we-are-going-to-talk-about">What we are going to talk about</a></li>
  <li><a href="#a-high-level-framing-why-xpt-feels-like-yesterdays-solution" id="toc-a-high-level-framing-why-xpt-feels-like-yesterdays-solution" class="nav-link" data-scroll-target="#a-high-level-framing-why-xpt-feels-like-yesterdays-solution">A high-level framing: why XPT feels like yesterday’s solution</a></li>
  </ul></li>
  <li><a href="#datasetjson" id="toc-datasetjson" class="nav-link" data-scroll-target="#datasetjson">datasetjson</a>
  <ul class="collapse">
  <li><a href="#a-brief-history-lesson" id="toc-a-brief-history-lesson" class="nav-link" data-scroll-target="#a-brief-history-lesson">A brief “history lesson”</a></li>
  <li><a href="#what-dataset-json-is-practically" id="toc-what-dataset-json-is-practically" class="nav-link" data-scroll-target="#what-dataset-json-is-practically">What Dataset-JSON is (practically)</a></li>
  <li><a href="#regulatory-context-and-momentum" id="toc-regulatory-context-and-momentum" class="nav-link" data-scroll-target="#regulatory-context-and-momentum">Regulatory context and momentum</a></li>
  <li><a href="#collaboration-framing-cdisc-phuse-fda-r-consortium" id="toc-collaboration-framing-cdisc-phuse-fda-r-consortium" class="nav-link" data-scroll-target="#collaboration-framing-cdisc-phuse-fda-r-consortium">Collaboration framing (CDISC / PHUSE / FDA / R Consortium)</a></li>
  </ul></li>
  <li><a href="#why-dataset-json-over-other-modern-formats" id="toc-why-dataset-json-over-other-modern-formats" class="nav-link" data-scroll-target="#why-dataset-json-over-other-modern-formats">WHY DATASET-JSON OVER OTHER MODERN FORMATS</a></li>
  <li><a href="#r-consortium-working-group" id="toc-r-consortium-working-group" class="nav-link" data-scroll-target="#r-consortium-working-group">R CONSORTIUM WORKING GROUP</a>
  <ul class="collapse">
  <li><a href="#what-is-the-focus" id="toc-what-is-the-focus" class="nav-link" data-scroll-target="#what-is-the-focus">What is the focus?</a></li>
  <li><a href="#successes-as-demonstrated-by-the-pilots" id="toc-successes-as-demonstrated-by-the-pilots" class="nav-link" data-scroll-target="#successes-as-demonstrated-by-the-pilots">Successes (as demonstrated by the pilots)</a></li>
  <li><a href="#problems-identified-and-iterations" id="toc-problems-identified-and-iterations" class="nav-link" data-scroll-target="#problems-identified-and-iterations">Problems identified and iterations</a></li>
  </ul></li>
  <li><a href="#pilot-5" id="toc-pilot-5" class="nav-link" data-scroll-target="#pilot-5">PILOT 5</a>
  <ul class="collapse">
  <li><a href="#focus-of-pilot-5-dataset-json-r-generated-adam" id="toc-focus-of-pilot-5-dataset-json-r-generated-adam" class="nav-link" data-scroll-target="#focus-of-pilot-5-dataset-json-r-generated-adam">Focus of Pilot 5 (Dataset-JSON + R-generated ADaM)</a></li>
  <li><a href="#way-of-working-reproducibility-first" id="toc-way-of-working-reproducibility-first" class="nav-link" data-scroll-target="#way-of-working-reproducibility-first">Way of working: reproducibility-first</a></li>
  <li><a href="#ai-infrastructure-where-it-helped" id="toc-ai-infrastructure-where-it-helped" class="nav-link" data-scroll-target="#ai-infrastructure-where-it-helped">AI infrastructure (where it helped)</a></li>
  <li><a href="#success-of-the-pilot-what-pilot-5-demonstrates" id="toc-success-of-the-pilot-what-pilot-5-demonstrates" class="nav-link" data-scroll-target="#success-of-the-pilot-what-pilot-5-demonstrates">Success of the Pilot (what Pilot 5 demonstrates)</a></li>
  <li><a href="#trials-and-tribulations-what-you-run-into-in-the-real-world" id="toc-trials-and-tribulations-what-you-run-into-in-the-real-world" class="nav-link" data-scroll-target="#trials-and-tribulations-what-you-run-into-in-the-real-world">Trials and tribulations (what you run into in the real world)</a></li>
  </ul></li>
  <li><a href="#mini-example-from-an-adam-data-frame-to-dataset-json" id="toc-mini-example-from-an-adam-data-frame-to-dataset-json" class="nav-link" data-scroll-target="#mini-example-from-an-adam-data-frame-to-dataset-json">MINI EXAMPLE: FROM AN ADAM DATA FRAME TO DATASET-JSON</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">CONCLUSION</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">REFERENCES</a></li>
  <li><a href="#recommended-reading" id="toc-recommended-reading" class="nav-link" data-scroll-target="#recommended-reading">RECOMMENDED READING</a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">ACKNOWLEDGMENTS</a></li>
  <li><a href="#contact-information" id="toc-contact-information" class="nav-link" data-scroll-target="#contact-information">CONTACT INFORMATION</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Breaking Free from the Xpt: Exploration of dataset.json as an Alternative Transport File to Regulatory Agencies</h1>
<p class="subtitle lead">Ben Straub, GSK, Philadelphia, United States <br> Sam Parmar, Pfizer, New York City, United States <br> Nick Masel, Johnson and Johnson, Raleigh, United States</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">ABSTRACT</h2>
<p>The SAS XPORT (XPT) transport file has been the de facto interchange format for SDTM and ADaM datasets in regulatory submissions for decades. While durable and widely supported, XPT is inherently constrained by legacy design decisions and is not a natural “first choice” format within modern open-source data ecosystems. The CDISC Dataset-JSON standard provides a contemporary alternative designed to represent clinical datasets and metadata using JavaScript Object Notation (JSON), enabling straightforward interaction across many programming languages and validation toolchains.</p>
<p>R Consortium R Submission Pilot 5 explored a fully reproducible, publicly accessible submission-like package centered on <strong>R-generated ADaM datasets</strong> and delivery of datasets in <strong>Dataset-JSON v1.1</strong>. The pilot demonstrates (1) converting study data inputs into analysis-ready datasets, (2) serializing datasets to Dataset-JSON using R, (3) regenerating key tables/figures from the R-derived datasets, and (4) implementing quality control comparisons to support confidence that artifacts match expectations and prior baselines.</p>
<p>This paper summarizes the background and motivations for Dataset-JSON, the R Consortium Working Group context, and the Pilot 5 implementation and lessons learned for teams evaluating Dataset-JSON as a viable alternative transport format for future submissions.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">INTRODUCTION</h2>
<section id="what-we-are-going-to-talk-about" class="level3">
<h3 class="anchored" data-anchor-id="what-we-are-going-to-talk-about">What we are going to talk about</h3>
<p>This paper covers four related topics:</p>
<ol type="1">
<li>Why the industry is reevaluating long-standing dataset transport assumptions (with XPT as the historical default).</li>
<li>What is Dataset-JSON, where it came from, and why it matters.</li>
<li>The R Consortium R Submissions Working Group context that enabled Pilot 5.</li>
<li>R Submission Pilot 5, with emphasis on the Dataset-JSON implementation, reproducible workflows, and what we learned.</li>
</ol>
</section>
<section id="a-high-level-framing-why-xpt-feels-like-yesterdays-solution" class="level3">
<h3 class="anchored" data-anchor-id="a-high-level-framing-why-xpt-feels-like-yesterdays-solution">A high-level framing: why XPT feels like yesterday’s solution</h3>
<p>XPT is not “bad”— as it is widely supported and deeply embedded in regulatory processes. However, when viewed through a modern software lens, it unduly burdens the acceptance of modern software practices and adoption of new data standards. In this section, we will lay out why the xpt is problematic.</p>
<p><strong>Outdated Technology:</strong> The format was defined in the 1980s and was designed for data transfer between SAS applications on different operating systems. It is not aligned with modern data architectures or standards like Fast Healthcare Interoperability Resources (FHIR) or big-data. The FDA adopted it as <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000464.shtml" target="_blank">non-proprietary data format</a> to submit for drug submissions.</p>
<p><strong>Limited Data Characteristics:</strong> Variable Names are restricted to a maximum of 8 characters and are case-insensitive. Variable Labels are limited to 40 characters. Character Variable Lengths cannot exceed 200 characters or bytes. Variable Types are limited to US ASCII for character variables and IBM INTEGER and DOUBLE for numeric variables.</p>
<p><strong>Poor Handling of International Characters:</strong> It only supports US ASCII character encoding, meaning it cannot natively handle multibyte characters or UTF-8. Representing international characters requires “tricks” or workarounds, which can lead to encoding and interpretation issues.</p>
<p><strong>Lack of Robust Metadata:</strong> The .xpt format has no direct way to embed rich metadata within the file itself. It relies on separate define.xml files, which introduces the risk of data and metadata mismatches if not carefully managed.</p>
<p><strong>Inefficient Storage:</strong> The format is inefficient, often leading to wasted storage space. It allocates fixed space for variables, and missing or shorter values are padded with blanks, which can result in up to 70% wasted space. It also does not support data compression.</p>
<p><strong>Ecosystem asymmetry:</strong> XPT is universally known in SAS-centric workflows, but is less native to open-source tooling and data engineering stacks.</p>
<p>This is the motivation for exploring Dataset-JSON: not to declare a villain, but to ask whether an alternative transport can reduce friction and better fit modern, reproducible, open toolchains while continuing to support reviewer needs.</p>
</section>
</section>
<section id="datasetjson" class="level2">
<h2 class="anchored" data-anchor-id="datasetjson">datasetjson</h2>
<section id="a-brief-history-lesson" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-history-lesson">A brief “history lesson”</h3>
<p>In 2022, the FDA evaluated alternatives to serve as possible replacements to SAS V5 XPT. The FDA determined that JSON was the optimal modern format to serve as a replacement to SAS V5 XPT. CDISC Datsaet-JSON v1.0 was released in Aug 2023 and the <a href="https://atorus-research.github.io/datasetjson/">datasetjson</a> R package supporting this version was released in Oct 2023. Dataset-JSON is a CDISC standard intended to represent clinical tabular datasets using JSON. It exists in the context of increasing adoption of structured data standards and the need to support interoperability beyond a single vendor ecosystem. It is designed to meet a wide range of data exchange scenarios including regulatory submissions and API-based data sharing.</p>
</section>
<section id="what-dataset-json-is-practically" class="level3">
<h3 class="anchored" data-anchor-id="what-dataset-json-is-practically">What Dataset-JSON is (practically)</h3>
<p>Dataset-JSON can be thought of as a standard way to serialize a dataset plus its metadata into JSON. In practical terms it enables:</p>
<ul>
<li>transport of rows/records in JSON form</li>
<li>representation of column metadata (name, label, type, etc.)</li>
<li>consistent schema that can be validated</li>
<li>contains one dataset per file</li>
<li>each dataset can optionally reference a Define-XML file</li>
</ul>
<p>The standard addresses requirements from the PHUSE 2017 <a href="https://www.cdisc.org/sites/default/files/2023-05/Transport-for-the-Next-Generation-Version-1.0.pdf" target="_blank">“Transport for the Next Generation”</a> paper. It follows a lowerCamelCase structure with three main components: top-level metadata (including creation datetime, version, and optional Define-XML references), column metadata (specifying variable names, labels, and data types), and row data arrays. It supports multiple data types with special handling for decimal precision (exchanged as strings to avoid rounding) and ISO 8601 format for date/time variables, with missing values represented as <code>null</code>. The standard also offers an NDJSON format (.ndjson) that enables streaming of large datasets by placing metadata on the first line and individual data rows on subsequent lines, allowing processing without loading entire datasets into memory.</p>
</section>
<section id="regulatory-context-and-momentum" class="level3">
<h3 class="anchored" data-anchor-id="regulatory-context-and-momentum">Regulatory context and momentum</h3>
<p>In April 2025, the FDA published a <a href="https://www.federalregister.gov/documents/2025/04/09/2025-06051/electronic-study-data-submission-data-standards-clinical-data-interchange-standards-consortium" target="_blank">Federal Register notice</a> reinforcing CDISC standards for electronic study data submission, signaling regulatory openness to transport format evolution. This context makes Dataset-JSON increasingly relevant as the industry evaluates alternatives to legacy transport mechanisms while maintaining compliance with CDISC standards.</p>
</section>
<section id="collaboration-framing-cdisc-phuse-fda-r-consortium" class="level3">
<h3 class="anchored" data-anchor-id="collaboration-framing-cdisc-phuse-fda-r-consortium">Collaboration framing (CDISC / PHUSE / FDA / R Consortium)</h3>
<p>Industry adoption of submission changes typically succeeds only where standards bodies, industry groups, and regulators align around feasibility and reviewer usability. Dataset-JSON exists within this collaborative ecosystem where CDISC defines standards, PHUSE supports applied use cases and community practice, and FDA engagement is critical to evaluate submission and review implications.</p>
<p>While this paper is not a policy paper, Pilot 5 is explicitly framed as an FDA–industry collaboration through the R Consortium and serves as a public “show your work” style example.</p>
</section>
</section>
<section id="why-dataset-json-over-other-modern-formats" class="level2">
<h2 class="anchored" data-anchor-id="why-dataset-json-over-other-modern-formats">WHY DATASET-JSON OVER OTHER MODERN FORMATS</h2>
<p>While modern formats like Parquet offer performance advantages for big data applications, <a href="https://swhume.github.io/top-10-reasons-dsj-over-parquet" target="_blank">Dataset-JSON provides specific benefits</a> for regulatory submissions:</p>
<ul>
<li><strong>Self-contained metadata:</strong> Variable labels, types, and CDISC-specific metadata are embedded directly in the file, eliminating external dependencies.</li>
<li><strong>Human-readable and audit-friendly:</strong> Text-based JSON enables review, comparison, and validation using standard development tools without specialized software.</li>
<li><strong>Universal parsing:</strong> JSON parsers exist in virtually every programming language, reducing implementation barriers across toolchains.</li>
<li><strong>API-Based Exchange</strong> Dataset-JSON supports both API and file based exchange</li>
</ul>
<p>Binary formats sacrifice these readability and auditability characteristics—considerations that matter critically in regulatory review contexts where transparency and reproducibility are paramount.</p>
</section>
<section id="r-consortium-working-group" class="level2">
<h2 class="anchored" data-anchor-id="r-consortium-working-group">R CONSORTIUM WORKING GROUP</h2>
<section id="what-is-the-focus" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-focus">What is the focus?</h3>
<p>The R Consortium R Submissions Working Group has focused on demonstrating that <strong>open-source, R-based submission packages</strong> can be organized, reproduced, and reviewed in a way that meets regulatory expectations. A key theme across pilots is transparency: making the full submission-like artifact available (data, code, documentation, and outputs), enabling learning and reuse across industry. The mission is:</p>
<ul>
<li>Easier R-based clinical trial regulatory submissions <strong>today</strong>
<ul>
<li>by showing open examples of using current submission portals</li>
</ul></li>
<li>Easier R-based clinical trial regulatory submissions <strong>tomorrow</strong>
<ul>
<li>by collecting feedback and influencing future industry and agency decisions on system/process setup</li>
</ul></li>
</ul>
<p>Each Pilot’s goals as well supporting documentation can be found on the R Consortium’s Submissions Working Group website. The link can be found below.</p>
</section>
<section id="successes-as-demonstrated-by-the-pilots" class="level3">
<h3 class="anchored" data-anchor-id="successes-as-demonstrated-by-the-pilots">Successes (as demonstrated by the pilots)</h3>
<p>Across the pilot work, the working group has demonstrated:</p>
<ul>
<li>submission-like packaging conventions (eCTD-style organization),</li>
<li>reproducible execution from raw/source materials through outputs,</li>
<li>public documentation (e.g., ADRG) aligning to reviewer needs,</li>
<li>practical workflows that teams can fork and adapt.</li>
</ul>
<p>Each Pilot has worked extensively with FDA reviewers to discuss issues from installation of packages, data issues, derivation in R and more. Once the Pilot is completed, the FDA provides recognition of the successful review with a “Statistical Review and Evaluation” letter. Pilot 3’s letter is linked in the Reference materials.</p>
</section>
<section id="problems-identified-and-iterations" class="level3">
<h3 class="anchored" data-anchor-id="problems-identified-and-iterations">Problems identified and iterations</h3>
<p>Exploring new transport mechanisms and reproducible workflows surfaces practical issues that do not always appear in “standards only” discussions, including:</p>
<ul>
<li>ensuring variable labels, formats, and metadata persist predictably across conversions,</li>
<li>managing numeric precision and representation choices,</li>
<li>aligning generated deliverables with reviewer expectations and available tooling,</li>
<li>maintaining robust QC evidence when changing transport mechanisms.</li>
</ul>
<p>Pilot 5 contains concrete code and QC artifacts illustrating how these issues can be surfaced, addressed, and documented in a public workflow. Pilot 5 uses <a href="https://cdisc-org.github.io/DataExchange-DatasetJson/doc/dataset-json1-1.html" target="_blank">Dataset-JSON v1.1</a> and demonstrates converting and producing these artifacts using R in a transparent manner.</p>
</section>
</section>
<section id="pilot-5" class="level2">
<h2 class="anchored" data-anchor-id="pilot-5">PILOT 5</h2>
<section id="focus-of-pilot-5-dataset-json-r-generated-adam" class="level3">
<h3 class="anchored" data-anchor-id="focus-of-pilot-5-dataset-json-r-generated-adam">Focus of Pilot 5 (Dataset-JSON + R-generated ADaM)</h3>
<p>Pilot 5 objectives include delivering a publicly accessible R-based submission package using Dataset-JSON, and expanding prior pilot approaches by generating ADaM datasets using R. For a little bit of history, Pilot 1 created 3 tables and 1 figure all in R, which was submitted to the FDA back in 2021. The SDTM and ADaM datasets used in Pilot 1 were produced in SAS as xpt files. Pilot 3 built on these 3 tables and 1 figure by now rebuilding the ADaM datasets in R and outputting as xpt files. However, there were only 5 datasets needed for the needs of the 3 tables and 1 figure - so only 5 were made in R. Remember the Pilots are more about investigating how the process works and less on the content created in R - hence the small package to help stay focused.</p>
<p>Now enter Pilot 5. Building off the success of Pilot 1 and Pilot 3 we wanted to see if all the xpt files in the submission package could be converted to datasetjson. The amazing datasetjson R package is available to help do a lot of the heavy lifting. See below for more information on it. As most of the code was in place for the tables, figures and ADaMs, we only had to add minimal code to produce the xpts into datasetjson.</p>
<p>The datasetjson R package also had a handy conversion program for moving existing xpts to datasetjson. The Pilots do not have access to the raw data and so the SDTM could not be re-created from scratch. Please see the below links to see Pilot 5 artifacts.</p>
<p>Primary public entry points include:</p>
<ul>
<li>Repo overview: <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson" target="_blank">https://github.com/RConsortium/submissions-pilot5-datasetjson</a></li>
<li>eCTD-like package README (Quarto): <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/ectd_readme/README.qmd" target="_blank">https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/ectd_readme/README.qmd</a><br>
</li>
<li>ADRG previews referenced by the repo README:
<ul>
<li>HTML: <a href="https://rpodcast.quarto.pub/pilot-5-aanalysis-data-reviewers-guide/" target="_blank">https://rpodcast.quarto.pub/pilot-5-aanalysis-data-reviewers-guide/</a></li>
<li>PDF: <a href="https://rsubmission-draft.us-east-1.linodeobjects.com/pilot5-adrg-quarto-pdf.pdf" target="_blank">https://rsubmission-draft.us-east-1.linodeobjects.com/pilot5-adrg-quarto-pdf.pdf</a></li>
</ul></li>
</ul>
</section>
<section id="way-of-working-reproducibility-first" class="level3">
<h3 class="anchored" data-anchor-id="way-of-working-reproducibility-first">Way of working: reproducibility-first</h3>
<p>Pilot 5 is organized to be rerunnable and inspectable, including:</p>
<ul>
<li>dataset generation programs under <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/tree/main/pilot5-submission/pilot5-programs"><code>pilot5-submission/pilot5-programs/</code></a> (e.g., <code>adsl.r</code>, <code>adae.r</code>, <code>adlbc.r</code>, <code>adtte.r</code>),</li>
<li>outputs and derived artifacts under <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/tree/main/pilot5-submission/pilot5-output"><code>pilot5-submission/pilot5-output/</code></a>,</li>
<li>documentation such as ADRG and eCTD README.</li>
</ul>
<p>Most importantly, Pilot 5 treats comparability as an artifact. For example:</p>
<ul>
<li><a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/qcReport.qmd"><code>qcReport.qmd</code></a> compares Pilot 5 ADaM datasets against prior baseline artifacts using <code>diffdf</code>.</li>
<li><a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/tlf-qc.qmd"><code>tlf-qc.qmd</code></a> supports comparing generated output artifacts, including text diffs and image-style comparisons.</li>
</ul>
</section>
<section id="ai-infrastructure-where-it-helped" class="level3">
<h3 class="anchored" data-anchor-id="ai-infrastructure-where-it-helped">AI infrastructure (where it helped)</h3>
<p>Pilot 5 includes experimental automation to assist documentation workflows, including LLM-assisted pipelines for extracting information (e.g., variables, datasets, and filters) from analysis code to support reviewer documentation tables (see <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/adrg/llm-adrg-utils/llm_pipeline.qmd"><code>adrg/llm-adrg-utils/llm_pipeline.qmd</code></a>). This is not positioned as a replacement for authoring, but as a mechanism to reduce manual effort and improve consistency when building reviewer-facing documentation from code.</p>
</section>
<section id="success-of-the-pilot-what-pilot-5-demonstrates" class="level3">
<h3 class="anchored" data-anchor-id="success-of-the-pilot-what-pilot-5-demonstrates">Success of the Pilot (what Pilot 5 demonstrates)</h3>
<p>Pilot 5 demonstrates, with a public reference implementation, that:</p>
<ul>
<li>Dataset-JSON can be produced in an R-driven pipeline with explicit metadata management.</li>
<li>A submission-like artifact can be packaged in a reviewer-friendly structure.</li>
<li>Outputs can be regenerated from the provided code and datasets.</li>
<li>QC comparisons can be scripted and reported to support confidence in the fidelity of the produced artifacts.</li>
</ul>
</section>
<section id="trials-and-tribulations-what-you-run-into-in-the-real-world" class="level3">
<h3 class="anchored" data-anchor-id="trials-and-tribulations-what-you-run-into-in-the-real-world">Trials and tribulations (what you run into in the real world)</h3>
<p>Pilot 5 encountered a couple of challenges along the way in bringing our submission package to the FDA grouped into standards and technical hurdle.</p>
<p>For standards, the first issue was that the standard of datasetjson had just switched from 1.0 to 1.1 so we needed to understand the differences for discussion with FDA. Second, we make use of the Validation software Pinnacle 21 Community v4.1.0 (the latest available at the time of writing), which helps ensure compliance for submissions packages. Unfortunately, the <a href="https://www.certara.com/announcement/pinnacle-21-releases-p21-community-4-1-0/" target="_blank">standard 1.1 was not available</a> in either the community or enterprise version of the software. A bit of setback, but we worked with our FDA partners to address and have documented this in the FDA submission. Once the standard 1.1 is available in the Pinnacle 21 we might re-submit.</p>
<p>For technical, the first issue was learning how the metadata is applied and stored in the datasetjson format as we have to ensure consistency. The second issue was learning about converting float variables to decimal data type in the JSON output. This was a bit of a thorn in our side in the initial development. Eventually, a wrapper function was built to help provide consistency across all the datasets. There are also a few limitations to the R package datasetjson which are being <a href="https://github.com/atorus-research/datasetjson/issues">looked into by the team</a>.</p>
</section>
</section>
<section id="mini-example-from-an-adam-data-frame-to-dataset-json" class="level2">
<h2 class="anchored" data-anchor-id="mini-example-from-an-adam-data-frame-to-dataset-json">MINI EXAMPLE: FROM AN ADAM DATA FRAME TO DATASET-JSON</h2>
<p>This section provides a minimal illustration of how Dataset-JSON can be produced in R in the same spirit as the Pilot 5 workflow. The goal is to show that Dataset-JSON creation is a reproducible, scriptable step that can be version-controlled and QC’d like any other artifact.</p>
<p>Pilot 5 conversion logic is exemplified by scripts such as <a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/pilot5-submission/pilot5-programs/convert_xpt_to_datasetjson.r"><code>pilot5-submission/pilot5-programs/convert_xpt_to_datasetjson.r</code></a> (read source data, ensure labels, derive column metadata, write Dataset-JSON).</p>
<p>Below is a simplified “toy” example mirroring that concept.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasetjson)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">STUDYID =</span> <span class="st">"CDISCPILOT01"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">USUBJID =</span> <span class="fu">c</span>(<span class="st">"01-701-1015"</span>, <span class="st">"01-701-1023"</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">TRT01A  =</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Xanomeline Low Dose"</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> <span class="fu">c</span>(<span class="dv">67</span>, <span class="dv">72</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset label (Pilot 5 ensures labels exist; may be derived from source metadata)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(adsl, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Subject-Level Analysis Dataset"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal column metadata (Pilot 5 derives more comprehensive metadata)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">itemOID =</span> <span class="fu">names</span>(adsl),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">names</span>(adsl),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Study Identifier"</span>, <span class="st">"Unique Subject Identifier"</span>, <span class="st">"Actual Treatment for Period 01"</span>, <span class="st">"Age"</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataType =</span> <span class="fu">c</span>(<span class="st">"string"</span>, <span class="st">"string"</span>, <span class="st">"string"</span>, <span class="st">"integer"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>ds_json <span class="ot">&lt;-</span> datasetjson<span class="sc">::</span><span class="fu">dataset_json</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  adsl,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_oid =</span> <span class="st">"ADSL"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"adsl"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_label =</span> <span class="fu">attr</span>(adsl, <span class="st">"label"</span>),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> columns</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>json_text <span class="ot">&lt;-</span> datasetjson<span class="sc">::</span><span class="fu">write_dataset_json</span>(ds_json, <span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># writeLines(json_text, "adsl.json")</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(json_text)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "datasetJSONCreationDateTime": "2026-02-02T18:44:47",
  "datasetJSONVersion": "1.1.0",
  "itemGroupOID": "ADSL",
  "records": 2,
  "name": "adsl",
  "label": "Subject-Level Analysis Dataset",
  "columns": [
    {
      "itemOID": "STUDYID",
      "name": "STUDYID",
      "label": "Study Identifier",
      "dataType": "string"
    },
    {
      "itemOID": "USUBJID",
      "name": "USUBJID",
      "label": "Unique Subject Identifier",
      "dataType": "string"
    },
    {
      "itemOID": "TRT01A",
      "name": "TRT01A",
      "label": "Actual Treatment for Period 01",
      "dataType": "string"
    },
    {
      "itemOID": "AGE",
      "name": "AGE",
      "label": "Age",
      "dataType": "integer"
    }
  ],
  "rows": [
    [
      "CDISCPILOT01",
      "01-701-1015",
      "Placebo",
      67.0
    ],
    [
      "CDISCPILOT01",
      "01-701-1023",
      "Xanomeline Low Dose",
      72.0
    ]
  ]
}</code></pre>
</div>
</div>
<p>Even in this simplified example, Dataset-JSON highlights two operational advantages that Pilot 5 leverages: - metadata is handled explicitly and can be audited, - the resulting artifact is plain text JSON and fits naturally into diffs, reviews, and automated checks.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">CONCLUSION</h2>
<p>R Consortium R Submission Pilot 5 provides a concrete, public example demonstrating that Dataset-JSON can be used as a realistic alternative transport format in a submission-like package while maintaining reproducibility and reviewability. The pilot shows that Dataset-JSON can support the same scientific intent and reproducibility expectations traditionally associated with XPT-based submissions. This is achieved by pairing Dataset-JSON with transparent dataset derivation code, explicit metadata management, and reviewer-oriented packaging and documentation (eCTD-like structure + ADRG). First-class QC reporting (dataset and output comparisons) further strengthens confidence in the approach. Together, these elements align more naturally with modern open-source data workflows while maintaining regulatory standards.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">REFERENCES</h2>
<p>Statistical Review and Evaluation. (2024). GitHub. https://github.com/RConsortium/submissions-wg/blob/main/_Documents/Summary_R_Pilot3_Submission.pdf</p>
<p>R Consortium R Submission Pilot 5 development repository. (2025). GitHub.<br>
https://github.com/RConsortium/submissions-pilot5-datasetjson</p>
<p>R Consortium Pilot 5 eCTD package overview. (2025). GitHub (Quarto source).<br>
https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/ectd_readme/README.qmd</p>
<p>FDA Electronic Common Technical Document (eCTD) overview. (n.d.). U.S. Food and Drug Administration.<br>
https://www.fda.gov/drugs/electronic-regulatory-submission-and-review/electronic-common-technical-document-ectd</p>
<p>CDISC SDTM &amp; ADaM Pilot Project (CDISCPilot01 source materials). (n.d.). GitHub.<br>
https://github.com/cdisc-org/sdtm-adam-pilot-project</p>
<p>Electronic Study Data Submission; Data Standards; Clinical Data Interchange Standards Consortium Dataset-JavaScript Object Notation; Request for Comments. Federal Register. (2025, April 9). https://www.federalregister.gov/documents/2025/04/09/2025-06051/electronic-study-data-submission-data-standards-clinical-data-interchange-standards-consortium</p>
<p>Github. (2025). Github Copilot (GPT-4.1, 14 April version) [Large Language Model]. https://github.com/copilot/</p>
<p>OpenAI. (2025). GPT-4.1 (14 April version) [Large language model]. https://platform.openai.com</p>
<p>OpenAI. (2025). GPT-5.1 (12 November version) [Large language model]. https://platform.openai.com</p>
</section>
<section id="recommended-reading" class="level2">
<h2 class="anchored" data-anchor-id="recommended-reading">RECOMMENDED READING</h2>
<p>Pilot 5 ADRG preview (public links referenced by the Pilot 5 repo README):</p>
<ul>
<li>HTML: https://rpodcast.quarto.pub/pilot-5-aanalysis-data-reviewers-guide/<br>
</li>
<li>PDF: https://rsubmission-draft.us-east-1.linodeobjects.com/pilot5-adrg-quarto-pdf.pdf</li>
</ul>
<p>QC reports in the Pilot 5 repo:</p>
<ul>
<li><a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/qcReport.qmd"><code>qcReport.qmd</code></a></li>
<li><a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/tlf-qc.qmd"><code>tlf-qc.qmd</code></a></li>
</ul>
<p>LLM-assisted ADRG utilities (Pilot 5 repo):</p>
<ul>
<li><a href="https://github.com/RConsortium/submissions-pilot5-datasetjson/blob/main/adrg/llm-adrg-utils/llm_pipeline.qmd"><code>adrg/llm-adrg-utils/llm_pipeline.qmd</code></a></li>
</ul>
</section>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments">ACKNOWLEDGMENTS</h2>
<p>The authors acknowledge the work of the <strong>R Consortium</strong> and the <strong>R Submissions Working Group</strong>, as well as the broader set of contributors who made the Pilot 5 repository, documentation, and reproducible workflows publicly available for the benefit of regulators, industry, and the open-source community.</p>
</section>
<section id="contact-information" class="level2">
<h2 class="anchored" data-anchor-id="contact-information">CONTACT INFORMATION</h2>
<p>Ben Straub<br>
GSK<br>
Philadelphia, United States</p>
<p>Sam Parmar<br>
Pfizer<br>
New York City, United States</p>
<p>Nick Masel<br>
Johnson and Johnson<br>
Raleigh, United States</p>
<p>Brand and product names are trademarks of their respective companies.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bms63\.github\.io\/phuse-datasetjson\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Created using <a href="https://quarto.org/docs/websites/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bms63/phuse-datasetjson">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>